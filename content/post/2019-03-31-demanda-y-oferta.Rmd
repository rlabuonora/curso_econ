---
title: Demanda y Oferta
author: ''
date: '2019-03-31'
slug: demanda-y-oferta
categories: []
tags: []
weight: 4
---


```{r setup, include = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.height=4, fig.width=6, warning=FALSE, message = FALSE)
library(tidyverse)
library(ggrepel)
library(cowplot)
library(knitr)

theme_set(theme_minimal() + 
            theme(plot.title = element_text(hjust = 0.5)))

```

- El modelo de oferta y demanda para entender los factores que afectan los precios y las cantidades que se comercian en un mercado.
- Vamos a analizar como responden a cambios en la tecnología y en los gustos de los consumidores (entre otros).
- Variables endógenas y exógenas.

# Demanda

- Ley de demanda
- La curva de demanda es la suma de las curvas de demanda de los individuos que participan del mercado.

```{r}
# Nordhaus pg. 46

df <- tribble(
  ~precio, ~cantidad, ~lab, ~momento,
  5,     9,           "A",  "Después",
  4,     10,          "B",  "Después",
  3,     12,          "B",  "Después",
  2,     15,          "D",  "Después",
  1,     20,          "E",  "Después"
)

ggplot(df, aes(x=cantidad, y=precio, color = momento)) + 
  geom_line() + 
  geom_point() +
  geom_text_repel(aes(label=lab), show.legend=FALSE) + 
  xlim(5, 20) + 
  ylim(0, 5) + 
  labs(x="Cantidad de Maíz",
       y="Precio del Maíz",
       title = "Demanda de Maíz",
       subtitle = "A medida que el precio se reduce los consumidores demandan más") +
  theme(legend.position = "none")

```

- Vamos a analizar este efecto más adelante.
- Precio y Cantidad son variables endógenas en este modelo, por lo que su relación es distinta que la relación entre el ingreso de los consumidores y el precio.
- Desplazamientos sobre la curva vs. desplazamientos de las curvas.
- Aumento en la demanda vs. aumento en la cantidad demanda.

## Factores que afectan la demanda
- Ingreso de los consumidores
- Tamaño del mercado
- Disponibilidad y precio de bienes relacionados
- Preferencias de los consumidores
- Factores coyunturales

Estos factores afectan _la relación entre precios y cantidades_. Si aumenta mi ingreso, para cada precio de una cena en un restaurant, voy a demandar más cantidad de cenas.


```{r, warning=FALSE}
df_2 <- bind_rows(
  df,
  mutate(df, 
         momento = "Antes",
         cantidad = cantidad-5)
)

ggplot(df_2, aes(x=cantidad, y=precio, color=momento)) + 
  geom_line() + 
  geom_point() +
  xlim(0, 20) + 
  ylim(0, 5) + 
  annotate("segment", x = 6, xend = 9, y=4, yend=4, arrow = arrow(length = unit(0.2, "cm"))) + 
  annotate("segment", x = 11, xend = 14, y=2, yend=2, arrow = arrow(length = unit(0.2, "cm"))) + 
  labs(x="Cantidad de Maíz",
       y="Precio del Maíz",
       title = "Demanda de Maíz",
       subtitle = "Si aumenta el ingreso de los consumidores la curva se desplaza hacia la derecha") +
  scale_color_discrete(name = "Momento")
```



# Oferta

Ley de oferta

```{r}
df_3 <- mutate(df, 
         cantidad_ofrecida = c(18, 16, 12, 7, 0))

ggplot(df_3, aes(x=cantidad_ofrecida, y=precio, color = momento)) + 
  geom_line() + 
  geom_point() +
  labs(x="Cantidad de Maíz",
       y="Precio del Maíz",
       title = "Oferta de Maíz",
       subtitle = "A medida que el precio se aumenta los productores producen más") +
  theme(legend.position = "none")
```

# Factores que desplazan la curva de oferta

- Precios de los inputs
- Tecnología
- Precios de bienes relacionados (ejemplo soja-maíz)
- Políticas del gobierno
- Factores coyunturales de cada mercado

# Equilibrio de mercado


```{r, eval = FALSE}


ggplot(df_3, aes(y=precio)) + 
  geom_line(aes(x=cantidad_ofrecida), color = "#00BFC4", size = 0.6) +   
  geom_line(aes(x=cantidad), color = "#F8766D", size = 0.6) +
  geom_segment(aes(x=0, y=0, xend=0, yend=1))
labs(x="Cantidad de Maíz",
       y="Precio del Maíz",
       title = "Equilibrio de Mercado",
       subtitle = "El precio que equilibra el mercado iguala oferta con demanda") +
  theme(legend.position = "none")
```
```{r}
library(reconPlots)
library(viridis)
x_max <- 5


line.1 <- data.frame(x = c(0, x_max),
                     y = c(0, x_max),
                     name="supply")

line.2 <- data.frame(x = c(x_max, 0),
                     y = c(0, x_max),
                     name="demand")

line.3 <- line.1 %>% 
  mutate(y = y + 2,
         name="demand_1")

line.intersection <- curve_intersect(line.1, line.2)

line.intersection.1 <- curve_intersect(line.3, line.2)

```


```{r}
ggplot(mapping = aes(x=x, y=y)) + 
  geom_line(data = line.1, aes(color=name)) + 
  geom_line(data = line.2, aes(color=name)) + 
  geom_segment(lty = "dashed", 
               aes(x=0, y = line.intersection$y, xend=line.intersection$x, yend=line.intersection$y)) + 
  geom_segment(lty = "dashed", 
               aes(x=line.intersection$x, y=0, xend=line.intersection$x, yend=line.intersection$y)) +
  scale_color_manual(name = NULL, 
                     labels = c("Demanda", "Oferta"),
                     values = c("#23576E", "#099FDB", 
                                "#29B00E", "#208F84", 
                                "#F55840", "#924F3E")) +
  scale_x_continuous(expand = c(0, 0.2), breaks = c(0, line.intersection$x), labels=c("", expression(~Q[0])))  +
  scale_y_continuous(expand = c(0, 0.2), breaks = c(0, line.intersection$y), labels=c("", expression(~P[0]))) + 
  geom_segment(aes(x = 0, y = 0, xend = 0, yend = 6), arrow = arrow(length=unit(0.2, "cm"))) +
  geom_segment(aes(x=0, y=0, xend = 6, yend = 0), arrow = arrow(length=unit(0.2, "cm"))) + 
  theme(axis.title.y = 
          element_text(angle = 0),
        axis.title.x = 
          element_text(hjust=0.95, vjust=6))  +
  labs(x="Q", y="P")
```

## Estática Comparativa

Un aumento de la demanda, provoca un aumento en la cantidad ofrecida y demandada y en una caída del precio.

```{r}
ggplot(mapping = aes(x=x, y=y)) + 
  geom_line(data = line.1, aes(group = 1, color=name)) + 
  geom_line(data = line.2, aes(group = 1, color=name)) + 
  geom_line(data = line.3, aes(group = 1, color=name)) + 
  geom_segment(lty = "dashed", 
               aes(x=0, y = line.intersection$y, xend=line.intersection$x, yend=line.intersection$y)) + 
  geom_segment(lty = "dashed", 
               aes(x=line.intersection$x, y=0, xend=line.intersection$x, yend=line.intersection$y)) + 
  geom_segment(lty = "dashed",
               aes(x=line.intersection.1$x, y=0, xend=line.intersection.1$x, yend=line.intersection.1$y)) + 
  geom_segment(lty = "dashed",
               aes(x=0, y=line.intersection.1$y, xend=line.intersection.1$x, yend=line.intersection.1$y)) + 
  annotate("point", x=line.intersection$x, y=line.intersection$y) + 
  annotate("point", x=line.intersection.1$x, y = line.intersection.1$y) + 
  ylim(c(0, 7)) + 
  geom_segment(aes(x = 0, y = 0, xend = 0, yend = 7), arrow = arrow(length=unit(0.2, "cm"))) +
  geom_segment(aes(x=0, y=0, xend = 7, yend = 0), arrow = arrow(length=unit(0.2, "cm"))) + 
  scale_color_manual( name="", values = c("#23576E", "#099FDB", 
                                 "#29B00E", "#208F84", 
                                 "#F55840", "#924F3E"),
                      labels=c("Oferta",
                               "Demanda (t=0)",
                               "Demanda (t=1)")) +
  annotate("segment", x=3.5, y=4.85, xend=3.9, yend=4.5, arrow = arrow(length = unit(0.2, "cm"))) +
  labs(x="", y="")

```

Ejemplo de la inmigración.
<!-- <iframe width="450" height="400" scrolling="no" frameborder="no"  src="https://rlabuonora.shinyapps.io/temp/"> </iframe> -->


# Ejercicios

1) Explicar porqué estas afirmaciones son falsas:
  - Una helada en uno de los estados productores de café de Brasil va a producir una caída en el precio del café.
  - El proteccionismo de la industria textil en Uruguay hace que los precios internos de los textiles bajen.
  - El aumento en los precios de la educación privada hace que baje la demanda de educación.
2) Para los siguientes casos, explicar si cambia la cantidad demandada o la demanda, dibujando un diagrama:
  - El aumento en el gasto militar hace que los uniformes suban de precios.
  - El precio del pescado bajó porque el Papa autorizó a los católicos a comer carne los viernes.
  - Un aumento en los impuestos a la nafta hace que el consumo de nafta baje.
  - Los salarios aumentaron luego de la llegada de la Peste Bubónica a Europa en el Siglo XIV.
  
3) Se tiene la siguiente información sobre el mercado de pizzas

Precio | Cantidad demandada  | Cantidad Ofrecida
-------| ------------------- |-------------
10     | 0                   | 40
8      | 10                  | 30
6      | 20                  | 20
4      | 30                  | 10
2      | 40                  | 0 
0      | 125                 | 0

1) Graficar la oferta y la demanda. Encontrar el punto de equilibrio del mercado. 
2) Si la demanda de Pizza se triplicara para todos los precios: ¿Qué pasaría si el precio inicial fuera de $4 por pizza?